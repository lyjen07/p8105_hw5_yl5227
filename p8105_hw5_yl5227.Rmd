---
title: "p8105_hw5_yl5227"
author: "Jennifer Li"
date: "2023-11-15"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
```

# Problem 1

Import dataset, create variable.

```{r}
df_homocide = 
  read_csv("data/homicide-data.csv", na = c("", "NA", "Unknown")) |> 
  mutate(
    city_state = str_c(city, state, sep = ", "),
    status = case_when(
      disposition == "Closed without arrest" ~ "unsolved",
      disposition == "Open/No arrest" ~ "unsolved",
      disposition == "Closed by arrest" ~ "solved",
      ))
```

This dataset gathered data on homicides in 50 large U.S. cities. The resulting dataframe has `r nrow(df_homocide)` entries, on variables that include the victim name, race, age, and sex; the date the homicide was reported; and the location of the homicide. In cleaning, I created a `city_state` variable that includes both city and state, and a `status` variable to indicate whether the case was closed by arrest. I also excluded one entry in Tulsa, AL, which is not a major US city and is most likely a data entry error.

Let's summarize total number of homicides and unsolved homicides within cities.

```{r}
df_city_homcide =
  df_homocide |> 
  select(city_state, status) |> 
  summarize(
    total_homocide = n(),
    unsolved_homocide = sum(status == "unsolved"))
```


# Problem 2

```{r}
df_all_participants =
  tibble(
    file_names = list.files(path = "data", pattern = "(con|exp)_\\d\\d.csv", full.names = TRUE),
    data = map(file_names, read_csv)) |> 
  separate(file_names, into = c("arm", "subject_id"), sep = "\\_") |> 
  mutate(
    arm = str_remove(arm, "data/"),
    subject_id = str_remove(subject_id, ".csv")
  ) |> 
  unnest(data) |> 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    names_prefix = "week_",
    values_to = "value"
  ) |> 
  mutate(week = as.numeric(week))
```


Make a spaghetti plot

```{r}
df_all_participants |> 
  ggplot(aes(x = week, y = value, group = str_c(subject_id,arm), color = arm)) +
  geom_line()
```



# Problem 3

```{r}




```

